<?php
    $itemCount = count($this->attachments);
?>

<div class="grix-x grid-container">
    <?php if (!empty($heading)): ?>
        <div class="media-text-heading">
            <h3 class="h2 padding-vertical-1"><?= $heading ?></h3>
        </div>
    <?php endif; ?>
</div>
<div class="full-width-css item-showcase-multiples grid-x grid-margin-x flex-container align-spaced small-padding-0">
    <?php foreach ($attachments as $attachment): ?>
        <div class="item-showcase card auto item item-count-<?php echo $itemCount; ?> resource flex-container flex-dir-column align-middlemargin-1 medium-margin-bottom-2">
            <?php
            $item = $attachment->item();
            if ($item):
                ?>
                <?php
                $title = $this->plugin('escapeHtml')($item->displayTitle());
                $media = $attachment->media() ?: $item->primaryMedia();
                if ($media):
                    $image = preg_match('/alt=""/', $this->thumbnail($media, $this->thumbnailType)) == 1 ? $item->linkRaw($this->thumbnail($media, $this->thumbnailType, ['alt' => $title])) : $item->linkRaw($this->thumbnail($media, $this->thumbnailType));
                    echo $image;
                endif;
                ?>
                <div class="separator-center">
                    <?php $showTitleOption = $this->showTitleOption; ?>
                    <?php if ($showTitleOption == 'item_title'): ?>
                        <h3 class="margin-top-1"><?php echo $item->link($item->displayTitle()); ?></h3>
                    <?php elseif ($showTitleOption == 'file_name'): ?>
                        <h3 class="margin-top-1"><?php echo $media->displayTitle(); ?></h3>
                    <?php endif; ?>
                <?php endif; ?>
                <?php
                    $date = $item->value('dcterms:date');
                    if ($date):
                    ?>
                    <h3><small date><?php echo $date; ?></small></h3>
                <?php endif; ?>
                <?php
                    $origin = $item->value('curation:location');
                    if ($origin):
                    ?>
                    <h3><small origin><?php echo $origin; ?></small></h3>
                <?php endif; ?>
                </div>
            <?php
            $caption = $attachment->caption();
            if ($caption):
                ?>
                <div class="caption font-wide padding-1 xlarge-padding-2 xlarge-padding-horizontal-3 flex-child-grow"><?php echo $caption; ?></div>
            <?php endif; ?>
        </div>
    <?php endforeach; ?>
</div>