<?php
$this->headLink()->appendStylesheet($this->assetUrl('css/annona.css')); 
$this->headScript()->appendFile($this->assetUrl('js/annona.js'));
?>

<div class="media-embed-block <?php echo $this->alignmentClass . ' ' . $this->thumbnailType; ?> file">
    <div class="attachments flex-container flex-dir-column">
    <?php foreach($this->attachments as $attachment): ?>
        <div class="item resource flex-container flex-dir-column">
        <?php
        $item = $attachment->item();
        if ($item):
        ?>
            <?php
            $media = $attachment->media() ?: $item->primaryMedia(); // Fixing the ternary operator syntax
            if ($media) {
                $mediaRenderer = $media->renderer();
                if ($mediaRenderer == 'iiif' || 'youtube' || 'audio' || 'video') {
                    echo $media->render([
                        'thumbnailType' => $thumbnailType,
                        'link' => $link,
                    ]);
                } else {
                    echo $this->thumbnail($media, $thumbnailType ?? 'large'); // Ensuring $thumbnailType is defined
                }
            } else {
                echo 'No media available'; // Optional: handle cases where no media exists
            }
            ?>
            <div class="metadata">
            <?php $showTitleOption = $this->showTitleOption; ?>
            <?php if ($showTitleOption == 'item_title'): ?>
            <h2><?php echo $item->displayTitle(); ?></h2>
            <?php elseif ($showTitleOption == 'file_name'): ?>
            <h2><?php echo $media->displayTitle(); ?></h2>
            <?php endif; ?>
            </div>
        <?php endif; ?>

        <?php
        $caption = $attachment->caption();
        if ($caption):
        ?>
            <div class="caption padding-1"><?php echo $caption; ?></div>
        <?php endif; ?>
        <div class="learn-more">
            <h2 class="hollow button medium warning hollow"><?php echo $item->link("View full item"); ?></h2>
        </div>
    </div>
<?php endforeach; ?>
    </div>
</div>